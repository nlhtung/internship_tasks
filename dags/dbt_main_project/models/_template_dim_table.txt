-- Example template for future dimension tables
-- Just copy this pattern and modify the source and columns

{{ config(
    materialized='incremental',
    file_format='iceberg',
    location_root='s3a://iceberg-warehouse/output/dimensions',
    table_properties={'write.format.default': 'parquet'},
    incremental_strategy='merge',
    unique_key='dim_[table]_id',
    merge_exclude_columns=['dim_[table]_id']
) }}

WITH source_data AS (
    SELECT * FROM {{ ref('stg_[source_table]') }}
)

{{ scd_type_2(
    source_table='source_data',
    unique_key='[business_key]',
    compare_columns=['col1', 'col2', 'col3']
) }}

-- Steps to create a new dimension:
-- 1. Create staging model: models/staging/stg_[source].sql
-- 2. Copy this template to models/dim_[name].sql
-- 3. Replace [table], [source_table], [business_key], and compare_columns
-- 4. Add to schema.yml files
