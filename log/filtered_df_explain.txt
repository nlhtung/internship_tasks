=== Execution Plan for filtered_df ===
== Physical Plan ==
AdaptiveSparkPlan (8)
+- Project (7)
   +- BroadcastHashJoin LeftOuter BuildRight (6)
      :- Filter (2)
      :  +- Scan csv  (1)
      +- BroadcastExchange (5)
         +- Filter (4)
            +- Scan csv  (3)


(1) Scan csv 
Output [25]: [ORDERNUMBER#17, QUANTITYORDERED#18, PRICEEACH#19, ORDERLINENUMBER#20, SALES#21, ORDERDATE#22, STATUS#23, QTR_ID#24, MONTH_ID#25, YEAR_ID#26, PRODUCTLINE#27, MSRP#28, PRODUCTCODE#29, CUSTOMERNAME#30, PHONE#31, ADDRESSLINE1#32, ADDRESSLINE2#33, CITY#34, STATE#35, POSTALCODE#36, COUNTRY#37, TERRITORY#38, CONTACTLASTNAME#39, CONTACTFIRSTNAME#40, DEALSIZE#41]
Batched: false
Location: InMemoryFileIndex [file:/mnt/c/Users/nlhtung/Study/DE/task_day_6/input/sales_data.csv]
PushedFilters: [IsNotNull(QUANTITYORDERED), IsNotNull(PRICEEACH)]
ReadSchema: struct<ORDERNUMBER:int,QUANTITYORDERED:int,PRICEEACH:double,ORDERLINENUMBER:int,SALES:double,ORDERDATE:string,STATUS:string,QTR_ID:int,MONTH_ID:int,YEAR_ID:int,PRODUCTLINE:string,MSRP:int,PRODUCTCODE:string,CUSTOMERNAME:string,PHONE:string,ADDRESSLINE1:string,ADDRESSLINE2:string,CITY:string,STATE:string,POSTALCODE:int,COUNTRY:string,TERRITORY:string,CONTACTLASTNAME:string,CONTACTFIRSTNAME:string,DEALSIZE:string>

(2) Filter
Input [25]: [ORDERNUMBER#17, QUANTITYORDERED#18, PRICEEACH#19, ORDERLINENUMBER#20, SALES#21, ORDERDATE#22, STATUS#23, QTR_ID#24, MONTH_ID#25, YEAR_ID#26, PRODUCTLINE#27, MSRP#28, PRODUCTCODE#29, CUSTOMERNAME#30, PHONE#31, ADDRESSLINE1#32, ADDRESSLINE2#33, CITY#34, STATE#35, POSTALCODE#36, COUNTRY#37, TERRITORY#38, CONTACTLASTNAME#39, CONTACTFIRSTNAME#40, DEALSIZE#41]
Condition : ((isnotnull(QUANTITYORDERED#18) AND isnotnull(PRICEEACH#19)) AND ((cast(QUANTITYORDERED#18 as double) * PRICEEACH#19) > 3000.0))

(3) Scan csv 
Output [2]: [PRODUCTCODE#84, PROMOTION_NAME#85]
Batched: false
Location: InMemoryFileIndex [file:/mnt/c/Users/nlhtung/Study/DE/task_day_6/input/promotions.csv]
PushedFilters: [IsNotNull(PRODUCTCODE)]
ReadSchema: struct<PRODUCTCODE:string,PROMOTION_NAME:string>

(4) Filter
Input [2]: [PRODUCTCODE#84, PROMOTION_NAME#85]
Condition : isnotnull(PRODUCTCODE#84)

(5) BroadcastExchange
Input [2]: [PRODUCTCODE#84, PROMOTION_NAME#85]
Arguments: HashedRelationBroadcastMode(List(input[0, string, false]),false), [plan_id=89]

(6) BroadcastHashJoin
Left keys [1]: [PRODUCTCODE#29]
Right keys [1]: [PRODUCTCODE#84]
Join type: LeftOuter
Join condition: None

(7) Project
Output [27]: [PRODUCTCODE#29, ORDERNUMBER#17, QUANTITYORDERED#18, PRICEEACH#19, ORDERLINENUMBER#20, SALES#21, ORDERDATE#22, STATUS#23, QTR_ID#24, MONTH_ID#25, YEAR_ID#26, PRODUCTLINE#27, MSRP#28, CUSTOMERNAME#30, PHONE#31, ADDRESSLINE1#32, ADDRESSLINE2#33, CITY#34, STATE#35, POSTALCODE#36, COUNTRY#37, TERRITORY#38, CONTACTLASTNAME#39, CONTACTFIRSTNAME#40, DEALSIZE#41, PROMOTION_NAME#85, (cast(QUANTITYORDERED#18 as double) * PRICEEACH#19) AS CALC_SALES#116]
Input [27]: [ORDERNUMBER#17, QUANTITYORDERED#18, PRICEEACH#19, ORDERLINENUMBER#20, SALES#21, ORDERDATE#22, STATUS#23, QTR_ID#24, MONTH_ID#25, YEAR_ID#26, PRODUCTLINE#27, MSRP#28, PRODUCTCODE#29, CUSTOMERNAME#30, PHONE#31, ADDRESSLINE1#32, ADDRESSLINE2#33, CITY#34, STATE#35, POSTALCODE#36, COUNTRY#37, TERRITORY#38, CONTACTLASTNAME#39, CONTACTFIRSTNAME#40, DEALSIZE#41, PRODUCTCODE#84, PROMOTION_NAME#85]

(8) AdaptiveSparkPlan
Output [27]: [PRODUCTCODE#29, ORDERNUMBER#17, QUANTITYORDERED#18, PRICEEACH#19, ORDERLINENUMBER#20, SALES#21, ORDERDATE#22, STATUS#23, QTR_ID#24, MONTH_ID#25, YEAR_ID#26, PRODUCTLINE#27, MSRP#28, CUSTOMERNAME#30, PHONE#31, ADDRESSLINE1#32, ADDRESSLINE2#33, CITY#34, STATE#35, POSTALCODE#36, COUNTRY#37, TERRITORY#38, CONTACTLASTNAME#39, CONTACTFIRSTNAME#40, DEALSIZE#41, PROMOTION_NAME#85, CALC_SALES#116]
Arguments: isFinalPlan=false

